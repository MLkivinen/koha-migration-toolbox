this really needs some cleanup
